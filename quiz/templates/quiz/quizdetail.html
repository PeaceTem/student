{% extends 'quiz/base.html' %}
{% load static %}
{% load social_share %}

{% block quizTitle %}
Quiz Detail
{% endblock quizTitle %}

{% block content %}

{% block quizCss %}
<link rel="stylesheet" href="{% static 'quiz/css/quizdetail.css' %}">
{% endblock quizCss %}
{% include 'messages.html' %}

<div class="detail">
    
        <div>
            <a href="{% url 'profile:profile' quiz.user.username %}">
                <div>
                    @{{quiz.user.username}}
                </div>
            </a>
        </div>
        <div class="categories">
                Categories:
                {% for category in quiz.categories.all %}
                    <span>{{category.title}}</span>
                {% endfor %}
        </div>
        <div >Title: {{quiz.title|capfirst}}</div>
        <div >{{quiz.description | safe}}</div> 
        <div >created by {{quiz.user|capfirst}}</div>
        <div >It was created on {{quiz.date|date:"Y-M-d"}} {{quiz.date|time:"H:i"}}</div> 
        <div >
                    {% if quiz.attempts < 2 %}
                        {{quiz.attempts}} attempt
                    {% else %}
                        {{quiz.attempts}} attempts
                    {% endif %}
        </div>
        <div class="questionLength">
                    {{quiz.questionLength}} questions
        </div>
        <div class="average">
                    {{quiz.average_score}}%
        </div>
        <div class="duration">
                    {{quiz.duration}} min
        </div>

        <div class="linkBx">
             {{quiz.likes.all.count}} likes
        </div>
        <div>
            <a href="{% url 'quiz:take-quiz' quiz.id %}">
                <p>
                    Take Quiz
                </p>
            </a>
        </div>
        {% if quiz.user == user %}
        <div>
            <a href="{% url 'quiz:quiz-update' quiz.id %}"><p>Edit Quiz</p></a>
        </div>
        <div>
            <a href="{% url 'quiz:delete-quiz' quiz.id %}"><p>Ã— Delete Quiz</p></a>
        </div>
        <div>
            <a href="{% url 'quiz:new-question' quiz.id %}"><p>+ Add More Questions</p></a>
        </div>
        {% endif %}
<div class="copy-link-container">
    <div class="label">
        Copy link
    </div>
    <div class="copy-text">
        <input id="copy-link" type="text" class="text" value="">
        <button onclick="copyFunction()">Copy</button>
    </div>
</div>

<div>
    {% post_to_facebook 'Quiz: {{quiz.title}} | Description: {{quiz.description}}.' object_or_url 'Share to Facebook' %}


</div>

<div>
    <a href="{% url 'quiz:quizzes' %}">Go back to home page</a>
</div>


<div>
    <img src="{{postAd.picture.url}}">
</div>

<div>
    {{postAd.description}}
</div>

<div>
    <a href="{{postAd.link}}" target="_blank">Visit Site</a>
</div>
</div>

<script>
    function copyFunction(){
    let copyText = document.getElementById('copy-link');
    copyText.select();
    copyText.setSelectionRange(0,99999);
    // document.execCommand("copy")
    navigator.clipboard.writeText(copyText.value)
    alert("Copied the text: " + copyText.value)
}
</script>

<script src="{% static 'quiz/js/copy.js' %}" type="text/javascript"></script>
{% endblock content %}
